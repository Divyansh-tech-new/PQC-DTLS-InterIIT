<p align="center">
  <img src="https://img.shields.io/badge/Post--Quantum-Cryptography-blueviolet?style=for-the-badge&logo=shield&logoColor=white" alt="PQC"/>
  <img src="https://img.shields.io/badge/DTLS-1.3-00ADD8?style=for-the-badge&logo=protocol&logoColor=white" alt="DTLS 1.3"/>
  <img src="https://img.shields.io/badge/RISC--V-VexRiscv-EF2D5E?style=for-the-badge&logo=riscv&logoColor=white" alt="RISC-V"/>
</p>

<h1 align="center">
  ğŸ” PQC-DTLS 1.3 for Constrained IoT Devices
</h1>

<p align="center">
  <b>Quantum-Resistant Secure Communication for Bare-Metal RISC-V Embedded Systems</b>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/License-MIT-green.svg?style=flat-square" alt="License"/>
  <img src="https://img.shields.io/badge/wolfSSL-5.6+-blue.svg?style=flat-square" alt="wolfSSL"/>
  <img src="https://img.shields.io/badge/LiteX-Simulation-orange.svg?style=flat-square" alt="LiteX"/>
  <img src="https://img.shields.io/badge/NIST-Approved-success.svg?style=flat-square" alt="NIST"/>
</p>

<p align="center">
  <i>ğŸ† Developed for Inter IIT Tech Meet 14.0 | Problem Statement by Q-trino Labs</i>
</p>

---

<p align="center">
  <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/c/c-original.svg" alt="C" width="40" height="40"/>
  <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/python/python-original.svg" alt="Python" width="40" height="40"/>
  <img src="https://raw.githubusercontent.com/devicons/devicon/master/icons/linux/linux-original.svg" alt="Linux" width="40" height="40"/>
</p>

---

## ğŸŒŸ Highlights

<table>
<tr>
<td width="50%">

### ğŸ›¡ï¸ Quantum-Resistant Security
- **ML-KEM-512 (Kyber)** for key exchange
- **Dilithium Level 2** for digital signatures  
- NIST FIPS 203/204 compliant algorithms

</td>
<td width="50%">

### ğŸ”§ Bare-Metal Implementation
- Zero OS dependency
- BIOS-level operation on RISC-V
- ~420 KB firmware footprint

</td>
</tr>
<tr>
<td width="50%">

### ğŸ”„ Robust Packet Handling
- Custom chunked UDP protocol
- CRC16 integrity verification
- Automatic packet reassembly

</td>
<td width="50%">

### ğŸ” Mutual Authentication
- Certificate-based identity verification
- Bi-directional trust establishment
- Production-ready security model

</td>
</tr>
</table>

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [System Architecture](#-system-architecture)
- [DTLS 1.3 Handshake Flow](#-dtls-13-handshake-flow)
- [Chunked Middleware Protocol](#-chunked-middleware-protocol)
- [Cryptographic Algorithms](#-cryptographic-algorithms)
- [Installation](#-installation)
- [Quick Start](#-quick-start)
- [Project Structure](#-project-structure)
- [Performance Metrics](#-performance-metrics)
- [Testing & Verification](#-testing--verification)
- [Troubleshooting](#-troubleshooting)
- [References](#-references)

---

## ğŸ¯ Overview

This project implements a **complete Post-Quantum Cryptographic (PQC) DTLS 1.3 stack** for resource-constrained IoT devices. It addresses the critical challenge of securing embedded systems against **future quantum computing threats** while operating under severe memory and computational constraints.

### Key Achievement

> âœ… **Successful mutual authentication and encrypted communication** between a bare-metal RISC-V IoT device and server using NIST-approved post-quantum cryptographic algorithms.

### Why Post-Quantum Now?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸš¨ HARVEST NOW, DECRYPT LATER                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Adversaries are collecting encrypted data TODAY that they will    â”‚
â”‚  decrypt when quantum computers become available (estimated 2030)   â”‚
â”‚                                                                     â”‚
â”‚  IoT devices deployed NOW may still be operational when this       â”‚
â”‚  threat materializes - they MUST use quantum-resistant crypto      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ System Architecture

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚        ARCHITECTURE OVERVIEW      â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               â”‚         â”‚                              â”‚         â”‚                               â”‚
â”‚   ğŸ–¥ï¸ RISC-V SIMULATION        â”‚         â”‚   ğŸ”„ UART-UDP BRIDGE         â”‚         â”‚   ğŸŒ DTLS PQC SERVER          â”‚
â”‚   (LiteX + Verilator)         â”‚  UART   â”‚   (Python Middleware)        â”‚   UDP   â”‚   (Native x86 Binary)         â”‚
â”‚                               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  TCP    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  4444   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ VexRiscv CPU @ 10MHzâ”‚     â”‚  1234   â”‚   â”‚ Chunked Protocol     â”‚   â”‚         â”‚   â”‚ wolfSSL 5.6+        â”‚     â”‚
â”‚   â”‚ 100 MB RAM          â”‚     â”‚         â”‚   â”‚ â”œâ”€ Packet Framing    â”‚   â”‚         â”‚   â”‚ â”œâ”€ DTLS 1.3         â”‚     â”‚
â”‚   â”‚ 32 KB ROM           â”‚     â”‚         â”‚   â”‚ â”œâ”€ CRC16 Validation  â”‚   â”‚         â”‚   â”‚ â”œâ”€ ML-KEM-512       â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚         â”‚   â”‚ â””â”€ Auto Reassembly   â”‚   â”‚         â”‚   â”‚ â””â”€ Dilithium L2     â”‚     â”‚
â”‚                               â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚         â”‚                              â”‚         â”‚                               â”‚
â”‚   â”‚ DTLS 1.3 Client     â”‚     â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ â”œâ”€ wolfSSL          â”‚     â”‚         â”‚   â”‚ Handles Large Msgs   â”‚   â”‚         â”‚   â”‚ Certificate         â”‚     â”‚
â”‚   â”‚ â”œâ”€ PQC Algorithms   â”‚     â”‚         â”‚   â”‚ â”œâ”€ 5KB+ DTLS records â”‚   â”‚         â”‚   â”‚ â”œâ”€ CA Verification  â”‚     â”‚
â”‚   â”‚ â””â”€ Embedded Certs   â”‚     â”‚         â”‚   â”‚ â””â”€ Multi-chunk split â”‚   â”‚         â”‚   â”‚ â””â”€ Mutual Auth      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                               â”‚         â”‚                              â”‚         â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                              â”‚                                        â”‚
         â”‚                                              â”‚                                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   ğŸ”’ SECURE CHANNEL        â”‚
                                    â”‚   AES-128-GCM Encrypted    â”‚
                                    â”‚   Post-Quantum Protected   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component Interaction Flow

```mermaid
sequenceDiagram
    participant C as ğŸ”§ RISC-V Client
    participant B as ğŸ”„ UART Bridge
    participant S as ğŸŒ DTLS Server
    
    Note over C,S: Phase 1: Connection Establishment
    C->>B: UART bytes (TCP:1234)
    B->>B: Buffer & Frame Detection
    B->>S: Chunked UDP Datagrams
    S->>S: Reassemble Chunks
    
    Note over C,S: Phase 2: DTLS 1.3 Handshake
    C->>S: ClientHello + ML-KEM Share
    S->>C: ServerHello + ML-KEM Ciphertext
    S->>C: Certificate (Dilithium)
    S->>C: CertificateVerify (Signature)
    C->>S: Certificate (Dilithium)
    C->>S: CertificateVerify (Signature)
    
    Note over C,S: Phase 3: Encrypted Communication
    C->>S: ğŸ” Application Data
    S->>C: ğŸ” Application Response
```

---

## ğŸ¤ DTLS 1.3 Handshake Flow

The handshake follows RFC 9147 (DTLS 1.3) with post-quantum cryptographic extensions:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DTLS 1.3 PQC HANDSHAKE SEQUENCE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Client (RISC-V IoT Device)                        Server (Linux Host)
           â”‚                                                 â”‚
           â”‚                                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚  Generate   â”‚                                   â”‚   Waiting   â”‚
    â”‚ ML-KEM Keys â”‚                                   â”‚ for Client  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                                 â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ClientHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
           â”‚  â”‚  â€¢ Client Random (32 bytes)                  â”‚
           â”‚  â”‚  â€¢ Cipher Suites (TLS_AES_128_GCM_SHA256)    â”‚
           â”‚  â”‚  â€¢ ML-KEM Public Key (1184 bytes)            â”‚
           â”‚  â”‚  â€¢ Dilithium Signature Algorithms            â”‚
           â”‚                                                 â”‚
           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ServerHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
           â”‚               â€¢ Server Random (32 bytes)    â”‚  â”‚
           â”‚               â€¢ Selected Cipher Suite       â”‚  â”‚
           â”‚               â€¢ ML-KEM Ciphertext (1088 B)  â”‚  â”‚
           â”‚                                             â”‚  â”‚
           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€ EncryptedExtensions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
           â”‚               â€¢ (encrypted from here)       â”‚  â”‚
           â”‚                                             â”‚  â”‚
           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Certificate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
           â”‚               â€¢ Server Dilithium Cert       â”‚  â”‚
           â”‚               â€¢ Public Key (1952 bytes)     â”‚  â”‚
           â”‚                                             â”‚  â”‚
           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CertificateVerify â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
           â”‚               â€¢ Dilithium Signature         â”‚  â”‚
           â”‚               â€¢ (3293 bytes)                â”‚  â”‚
           â”‚                                             â”‚  â”‚
           â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
           â”‚               â€¢ Handshake MAC                   â”‚
           â”‚                                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
    â”‚   Verify    â”‚        â”‚ Derive Session Keys  â”‚         â”‚
    â”‚   Server    â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ Client Write Key   â”‚         â”‚
    â”‚ Certificate â”‚        â”‚ â€¢ Server Write Key   â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚ â€¢ Traffic Secrets    â”‚         â”‚
           â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
           â”‚                                                 â”‚
           â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Certificate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
           â”‚               â€¢ Client Dilithium Cert          â”‚
           â”‚                                                 â”‚
           â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CertificateVerify â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
           â”‚               â€¢ Client Signature               â”‚
           â”‚                                                 â”‚
           â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
           â”‚                                                 â”‚
           â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
           â”‚                   â”‚ Verify Client &  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚
           â”‚                   â”‚ Derive App Keys  â”‚         â”‚
           â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
           â”‚                            â”‚                    â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚                            â”‚                    â”‚
           â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SECURE CHANNEL â•â•â•â•â•â•â•â•â•â•â•   â”‚
           â”‚                            â”‚                    â”‚
           â”‚  â—„â•â•â•â•â•â•â•â•â•â• Encrypted Application Data â•â•â•â•â•â–º â”‚
           â”‚         (AES-128-GCM with Perfect Forward       â”‚
           â”‚          Secrecy & Quantum Resistance)          â”‚
           â”‚                                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚   âœ“ SECURE  â”‚                                   â”‚   âœ“ SECURE  â”‚
    â”‚  CONNECTED  â”‚                                   â”‚  CONNECTED  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Exchange Details

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ML-KEM-512 KEY EXCHANGE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Client                              Server                     â”‚
â”‚    â”‚                                   â”‚                        â”‚
â”‚    â”‚  1. Generate ephemeral            â”‚                        â”‚
â”‚    â”‚     keypair (pk, sk)              â”‚                        â”‚
â”‚    â”‚         â”‚                         â”‚                        â”‚
â”‚    â”‚         â”‚                         â”‚                        â”‚
â”‚    â”‚  2. Send public key â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  3. Encapsulate        â”‚
â”‚    â”‚     (1184 bytes)                  â”‚     shared secret      â”‚
â”‚    â”‚                                   â”‚         â”‚              â”‚
â”‚    â”‚                                   â”‚         â”‚              â”‚
â”‚    â”‚  4. Receive ciphertext â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (1088 bytes)          â”‚
â”‚    â”‚                                   â”‚         â”‚              â”‚
â”‚    â”‚  5. Decapsulate to                â”‚         â”‚              â”‚
â”‚    â”‚     get shared secret             â”‚         â”‚              â”‚
â”‚    â”‚         â”‚                         â”‚         â”‚              â”‚
â”‚    â”‚         â–¼                         â”‚         â–¼              â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  â”‚            IDENTICAL 32-BYTE SHARED SECRET          â”‚   â”‚
â”‚    â”‚  â”‚     (Used as input to HKDF for session keys)        â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Chunked Middleware Protocol

### The Problem

Large DTLS records (especially with PQC certificates ~5KB+) cannot be transmitted reliably over constrained UART-to-UDP bridges:

```
âŒ PROBLEM: Raw transmission causes garbled data

     TCP Stream (UART)              UDP Datagrams
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚AAABBBCCCDDDEEE..â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚AAA???????â”‚ â† Data Lost!
    â”‚(continuous flow)â”‚            â”‚BBB???????â”‚ â† Corrupted!
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚DDDEE?????â”‚ â† Out of order!
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### The Solution: Chunked UDP Protocol

We implemented a **custom framing protocol** with 16-byte headers for reliable transmission:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CHUNKED UDP PROTOCOL FRAME FORMAT                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Header (16 bytes)                         Payload (up to 1400 bytes)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Magic â”‚ MsgID â”‚ChunkIDâ”‚ Total â”‚ Len â”‚CRCâ”‚ â”‚     Actual DTLS Data    â”‚ â”‚
â”‚  â”‚  4B   â”‚  4B   â”‚  2B   â”‚  2B   â”‚ 2B  â”‚2B â”‚ â”‚                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  Field Descriptions:                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚  â€¢ Magic (0xCDAB1234) - Protocol identifier for validation               â”‚
â”‚  â€¢ Message ID        - Unique identifier for each DTLS record            â”‚
â”‚  â€¢ Chunk ID          - Current chunk number (0-indexed)                  â”‚
â”‚  â€¢ Total Chunks      - Total number of chunks for this message           â”‚
â”‚  â€¢ Chunk Length      - Payload size in this datagram                     â”‚
â”‚  â€¢ CRC16             - Integrity checksum of payload                     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Transmission Example

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              5KB DTLS CERTIFICATE TRANSMISSION EXAMPLE                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Original Message: 5000 bytes DTLS Certificate Record
Max Chunk Size:   1400 bytes
Chunks Required:  âŒˆ5000 / 1400âŒ‰ = 4 chunks

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHUNK 0/3                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Magic:     0xCDAB1234    â”‚ Payload: Bytes 0-1399 of certificate â”‚    â”‚
â”‚ â”‚ Msg ID:    42            â”‚ (1400 bytes)                         â”‚    â”‚
â”‚ â”‚ Chunk ID:  0             â”‚                                      â”‚    â”‚
â”‚ â”‚ Total:     4             â”‚                                      â”‚    â”‚
â”‚ â”‚ Length:    1400          â”‚                                      â”‚    â”‚
â”‚ â”‚ CRC16:     0xA3F2        â”‚                                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHUNK 1/3                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Magic:     0xCDAB1234    â”‚ Payload: Bytes 1400-2799             â”‚    â”‚
â”‚ â”‚ Msg ID:    42            â”‚ (1400 bytes)                         â”‚    â”‚
â”‚ â”‚ Chunk ID:  1             â”‚                                      â”‚    â”‚
â”‚ â”‚ Total:     4             â”‚                                      â”‚    â”‚
â”‚ â”‚ Length:    1400          â”‚                                      â”‚    â”‚
â”‚ â”‚ CRC16:     0x7B91        â”‚                                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHUNK 2/3                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Magic:     0xCDAB1234    â”‚ Payload: Bytes 2800-4199             â”‚    â”‚
â”‚ â”‚ Msg ID:    42            â”‚ (1400 bytes)                         â”‚    â”‚
â”‚ â”‚ Chunk ID:  2             â”‚                                      â”‚    â”‚
â”‚ â”‚ Total:     4             â”‚                                      â”‚    â”‚
â”‚ â”‚ Length:    1400          â”‚                                      â”‚    â”‚
â”‚ â”‚ CRC16:     0x2E44        â”‚                                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHUNK 3/3 (Final)                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Magic:     0xCDAB1234    â”‚ Payload: Bytes 4200-4999             â”‚    â”‚
â”‚ â”‚ Msg ID:    42            â”‚ (800 bytes - final chunk)            â”‚    â”‚
â”‚ â”‚ Chunk ID:  3             â”‚                                      â”‚    â”‚
â”‚ â”‚ Total:     4             â”‚                                      â”‚    â”‚
â”‚ â”‚ Length:    800           â”‚                                      â”‚    â”‚
â”‚ â”‚ CRC16:     0xD127        â”‚                                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â†“
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  REASSEMBLY   â”‚
                           â”‚   at Server   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ âœ“ Complete 5000-byte record  â”‚
                    â”‚   ready for DTLS processing  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Reassembly State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RECEIVER STATE MACHINE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   IDLE STATE    â”‚
                      â”‚ (No active msg) â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ Receive Chunk (Msg ID = N)
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”Œâ”€â”€â”€â”€â”€â–ºâ”‚  RECEIVING      â”‚â—„â”€â”€â”€â”€â”€â”€â”
               â”‚      â”‚ Message ID: N   â”‚       â”‚
               â”‚      â”‚ Got: 1/4 chunks â”‚       â”‚
               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
               â”‚               â”‚                â”‚
               â”‚               â”‚ More chunks    â”‚
               â”‚               â–¼                â”‚
               â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
               â”‚      â”‚  ACCUMULATING   â”‚â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚      â”‚ Got: 2/4, 3/4   â”‚  Still incomplete
               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚               â”‚
               â”‚               â”‚ Final chunk received (4/4)
               â”‚               â–¼
               â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚      â”‚   COMPLETE!     â”‚
               â”‚      â”‚ âœ“ CRC verified  â”‚
               â”‚      â”‚ âœ“ All chunks    â”‚
               â”‚      â”‚ â†’ Reassemble    â”‚
               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚               â”‚
               â”‚               â”‚ Return complete message
               â”‚               â–¼
               â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚      â”‚ DELIVER TO      â”‚
               â””â”€â”€â”€â”€â”€â”€â”‚ DTLS STACK      â”‚
                      â”‚ (wolfSSL)       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Protocol Benefits

| Feature | Benefit |
|---------|---------|
| **Magic Number** | Reject non-protocol packets |
| **Message ID** | Track concurrent multi-message streams |
| **Chunk ID** | Ensure correct reassembly order |
| **Total Chunks** | Know when message is complete |
| **CRC16** | Detect corrupted chunks |
| **Timeout Handling** | Clean up incomplete messages |

---

## ğŸ” Cryptographic Algorithms

### Algorithm Suite

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POST-QUANTUM CRYPTOGRAPHIC SUITE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ML-KEM-512 (Kyber)                             â”‚   â”‚
â”‚  â”‚                    Key Encapsulation Mechanism                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Purpose:      Quantum-resistant key exchange                     â”‚   â”‚
â”‚  â”‚  Security:     128-bit post-quantum (NIST Level 1)                â”‚   â”‚
â”‚  â”‚  Public Key:   1,184 bytes                                        â”‚   â”‚
â”‚  â”‚  Ciphertext:   1,088 bytes                                        â”‚   â”‚
â”‚  â”‚  Shared Key:   32 bytes                                           â”‚   â”‚
â”‚  â”‚  Basis:        Module Learning With Errors (MLWE)                 â”‚   â”‚
â”‚  â”‚  Standard:     NIST FIPS 203                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    DILITHIUM LEVEL 2                              â”‚   â”‚
â”‚  â”‚                    Digital Signature Scheme                        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Purpose:      Quantum-resistant authentication                   â”‚   â”‚
â”‚  â”‚  Security:     128-bit post-quantum (NIST Level 2)                â”‚   â”‚
â”‚  â”‚  Public Key:   1,952 bytes                                        â”‚   â”‚
â”‚  â”‚  Signature:    3,293 bytes                                        â”‚   â”‚
â”‚  â”‚  Secret Key:   4,000 bytes                                        â”‚   â”‚
â”‚  â”‚  Basis:        Module Lattice (Fiat-Shamir with Aborts)           â”‚   â”‚
â”‚  â”‚  Standard:     NIST FIPS 204 (ML-DSA-44)                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    AES-128-GCM                                    â”‚   â”‚
â”‚  â”‚                    Symmetric Encryption                            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Purpose:      Bulk data encryption + authentication             â”‚   â”‚
â”‚  â”‚  Key Size:     128 bits                                           â”‚   â”‚
â”‚  â”‚  Mode:         Galois/Counter Mode (AEAD)                         â”‚   â”‚
â”‚  â”‚  IV Size:      96 bits                                            â”‚   â”‚
â”‚  â”‚  Tag Size:     128 bits                                           â”‚   â”‚
â”‚  â”‚  Standard:     NIST SP 800-38D                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Security Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                CLASSICAL vs POST-QUANTUM SECURITY                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Algorithm        â”‚ Classical Security â”‚ Quantum Security â”‚ Status    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   RSA-2048         â”‚ 112 bits           â”‚ 0 bits âš ï¸        â”‚ BROKEN     â”‚
â”‚   ECDSA-256        â”‚ 128 bits           â”‚ 0 bits âš ï¸        â”‚ BROKEN     â”‚
â”‚   ECDH-P256        â”‚ 128 bits           â”‚ 0 bits âš ï¸        â”‚ BROKEN     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚   ML-KEM-512       â”‚ 128 bits           â”‚ 128 bits âœ“       â”‚ SECURE     â”‚
â”‚   Dilithium L2     â”‚ 128 bits           â”‚ 128 bits âœ“       â”‚ SECURE     â”‚
â”‚   AES-128-GCM      â”‚ 128 bits           â”‚ 64 bits  âœ“       â”‚ SECURE*    â”‚
â”‚                                                                         â”‚
â”‚   * Grover's algorithm reduces AES security by half, but AES-128        â”‚
â”‚     remains computationally secure against quantum attacks              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Installation

### Prerequisites

| Requirement | Minimum Version | Purpose |
|-------------|-----------------|---------|
| Ubuntu/Debian | 20.04 LTS | Operating System |
| GCC | 9.0+ | Native compilation |
| RISC-V Toolchain | Any | Cross-compilation |
| Python | 3.8+ | Bridge scripts |
| Verilator | 4.0+ | RTL simulation |

### Step 1: System Dependencies

```bash
sudo apt-get update && sudo apt-get install -y \
    build-essential \
    gcc-riscv64-unknown-elf \
    binutils-riscv64-unknown-elf \
    libtool autoconf automake \
    python3 python3-pip \
    git wget verilator
```

### Step 2: Python Packages

```bash
# Core packages
pip3 install --user meson ninja litex

# LiteX components
pip3 install --user \
    git+https://github.com/litex-hub/pythondata-cpu-vexriscv.git \
    git+https://github.com/litex-hub/pythondata-software-compiler_rt.git \
    git+https://github.com/litex-hub/pythondata-software-picolibc.git

# Add to PATH
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```

### Step 3: wolfSSL with PQC Support

```bash
cd Constraint_Env_SimI/Constraint_Env_Sim
sudo ./install_wolfssl.sh
```

This configures wolfSSL with:
- âœ… DTLS 1.3 support
- âœ… Dilithium signature algorithms
- âœ… ML-KEM (Kyber) key exchange
- âœ… Optimizations for embedded systems

### Step 4: Generate PQC Certificates

```bash
./generate_pqc_certs.sh
```

**Generated files:**
```
pqc_certs/
â”œâ”€â”€ ca-pub.der          # Certificate Authority
â”œâ”€â”€ server-pub.der      # Server certificate (Dilithium)
â”œâ”€â”€ server-key.der      # Server private key
â”œâ”€â”€ client-pub.der      # Client certificate (Dilithium)
â””â”€â”€ client-key.der      # Client private key
```

---

## ğŸš€ Quick Start

### Automated Demo (Recommended)

```bash
cd Constraint_Env_SimI/Constraint_Env_Sim
./run_demo.sh
```

**Expected Output:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ” DTLS 1.3 Post-Quantum Cryptography Demo
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[+] Starting DTLS PQC Server...
[+] Building LiteX RISC-V Simulation (60-75s)...
[+] Starting UART-UDP Bridge...
[+] Monitoring handshake...

[Server] Received ClientHello
[Server] Sending ServerHello with ML-KEM parameters
[Server] âœ“ Client certificate verified (Dilithium)
[Server] Computing ML-KEM shared secret...
[Server] âœ“ Session keys derived

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“âœ“âœ“ SUCCESS! DTLS 1.3 Post-Quantum Handshake Completed âœ“âœ“âœ“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Cryptographic Details:
  â€¢ Key Exchange: ML-KEM-512 (Kyber)
  â€¢ Signatures:   Dilithium Level 2
  â€¢ Cipher Suite: TLS_AES_128_GCM_SHA256
  â€¢ Auth Mode:    Mutual (Certificate-based)

Total Time: ~90 seconds
```

### Manual Execution (3 Terminals)

**Terminal 1 - DTLS Server:**
```bash
cd dtls_server
./dtls_pqc_server
```

**Terminal 2 - LiteX Simulation:**
```bash
litex_sim \
    --cpu-type=vexriscv \
    --cpu-variant=full \
    --integrated-main-ram-size=0x06400000 \
    --ram-init=boot.fbi
```

**Terminal 3 - UART Bridge:**
```bash
python3 uart_udp_bridge_chunked.py \
    --tcp-host 127.0.0.1 --tcp-port 1234 \
    --udp-local-ip 127.0.0.1 \
    --udp-remote-ip 127.0.0.1 --udp-remote-port 4444
```

---

## ğŸ“ Project Structure

```
PQC-DTLS-RISCV/
â”‚
â”œâ”€â”€ ğŸ“‚ Constraint_Env_SimI/Constraint_Env_Sim/    # Main implementation
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”§ boot/                                   # RISC-V firmware source
â”‚   â”‚   â”œâ”€â”€ main.c                                 # DTLS client implementation
â”‚   â”‚   â”œâ”€â”€ Makefile                               # Build configuration
â”‚   â”‚   â””â”€â”€ linker.ld                              # Memory layout
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸŒ dtls_server/                            # Native DTLS server
â”‚   â”‚   â”œâ”€â”€ dtls_pqc_server.c                      # Server implementation
â”‚   â”‚   â””â”€â”€ Makefile                               # Build configuration
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”„ Bridge & Protocol
â”‚   â”‚   â”œâ”€â”€ uart_udp_bridge.py                     # Basic bridge
â”‚   â”‚   â”œâ”€â”€ uart_udp_bridge_chunked.py             # Chunked protocol bridge
â”‚   â”‚   â”œâ”€â”€ chunked_udp_protocol.py                # Protocol implementation
â”‚   â”‚   â””â”€â”€ dtls_server_chunked_wrapper.py         # Server wrapper
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ” pqc_certs/                              # Generated certificates
â”‚   â”‚   â”œâ”€â”€ ca-pub.der
â”‚   â”‚   â”œâ”€â”€ server-pub.der / server-key.der
â”‚   â”‚   â””â”€â”€ client-pub.der / client-key.der
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“œ Scripts
â”‚   â”‚   â”œâ”€â”€ run_demo.sh                            # â­ Main demo script
â”‚   â”‚   â”œâ”€â”€ build_firmware.sh                      # Build RISC-V binary
â”‚   â”‚   â”œâ”€â”€ install_wolfssl.sh                     # Install wolfSSL
â”‚   â”‚   â””â”€â”€ generate_pqc_certs.sh                  # Generate certificates
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ—‚ï¸ Generated Files
â”‚       â”œâ”€â”€ boot.bin / boot.elf / boot.fbi         # Firmware binaries
â”‚       â””â”€â”€ logs/                                   # Runtime logs
â”‚
â”œâ”€â”€ ğŸ“‚ Additional Modules/                          # Supplementary code
â”‚   â”œâ”€â”€ main.c                                      # Client reference
â”‚   â”œâ”€â”€ user_settings.h                             # wolfSSL config
â”‚   â””â”€â”€ pqc_certs.h                                 # Embedded certificates
â”‚
â”œâ”€â”€ ğŸ“‚ Server Config/                               # Server utilities
â”‚   â”œâ”€â”€ dtls_pqc_server.c                           # Server source
â”‚   â””â”€â”€ uart_udp_bridge.py                          # Bridge script
â”‚
â”œâ”€â”€ ğŸ“‚ Evidence/                                    # Demo captures
â”‚   â”œâ”€â”€ capture.pcap                                # Packet capture
â”‚   â””â”€â”€ CaptureScreenshot.jpg                       # Visual proof
â”‚
â”œâ”€â”€ ğŸ“„ Final_Report_82.pdf                          # Technical documentation
â””â”€â”€ ğŸ“„ README.md                                    # This file
```

---

## ğŸ“Š Performance Metrics

### Handshake Performance

| Operation | Simulated (10MHz) | Estimated (100MHz) |
|-----------|-------------------|-------------------|
| ML-KEM KeyGen | 20-40 ms | 2-4 ms |
| ML-KEM Encapsulate | 10-20 ms | 1-2 ms |
| ML-KEM Decapsulate | 10-20 ms | 1-2 ms |
| Dilithium Sign | 20-40 ms | 2-4 ms |
| Dilithium Verify | 15-30 ms | 1.5-3 ms |
| **Full Handshake** | **30-60 sec** | **<1 sec** |

### Memory Footprint

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FIRMWARE MEMORY BREAKDOWN          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  Component           â”‚ Size     â”‚ % Total   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  wolfSSL Library     â”‚ ~350 KB  â”‚ 83%       â”‚
â”‚  PQC Algorithms      â”‚ ~50 KB   â”‚ 12%       â”‚
â”‚  Application Code    â”‚ ~15 KB   â”‚ 4%        â”‚
â”‚  Embedded Certs      â”‚ ~5 KB    â”‚ 1%        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  TOTAL ROM           â”‚ ~420 KB  â”‚ 100%      â”‚
â”‚                                             â”‚
â”‚  Runtime RAM         â”‚ ~2 MB    â”‚           â”‚
â”‚  (Crypto buffers)                           â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bandwidth Analysis

| Message Type | Size | Chunks (1400B) |
|--------------|------|----------------|
| ClientHello | ~1.5 KB | 2 |
| ServerHello | ~1.2 KB | 1 |
| Certificate (Dilithium) | ~4.5 KB | 4 |
| CertificateVerify | ~3.5 KB | 3 |
| **Total Handshake** | **~15 KB** | **~12** |

---

## ğŸ§ª Testing & Verification

### Run End-to-End Test

```bash
cd Constraint_Env_SimI/Constraint_Env_Sim
python3 test_chunked_e2e.py
```

**Expected Output:**
```
================================================================================
CHUNKED UDP PROTOCOL END-TO-END TEST
================================================================================

Test 1: Small Message (33 bytes)
  [SENDER] Msg 0: 33 bytes â†’ 1 chunk
  [RECEIVER] âœ“ Message 0 COMPLETE: 33 bytes reassembled
  âœ“ PASS

Test 2: Medium Message (3000 bytes)
  [SENDER] Msg 1: 3000 bytes â†’ 3 chunks
  [RECEIVER] âœ“ Message 1 COMPLETE: 3000 bytes reassembled
  âœ“ PASS

Test 3: Large Message (5500 bytes)
  [SENDER] Msg 2: 5500 bytes â†’ 4 chunks
  [RECEIVER] âœ“ Message 2 COMPLETE: 5500 bytes reassembled
  âœ“ PASS

================================================================================
RESULTS: 3/3 tests passed
Stats: {'chunks_received': 8, 'messages_completed': 3, 'crc_errors': 0}
================================================================================
```

### Verify Protocol Implementation

```bash
python3 chunked_udp_protocol.py
```

### Inspect Packet Captures

```bash
# Analyze existing captures
python3 check_reassembly_simple.py

# Create new capture during live demo
./capture_real_encrypted_traffic.sh
```

---

## ğŸ”§ Troubleshooting

<details>
<summary><b>âŒ Build Error: wolfssl/ssl.h not found</b></summary>

```bash
sudo ldconfig
ls /usr/local/include/wolfssl/

# If empty, reinstall:
cd Constraint_Env_SimI/Constraint_Env_Sim
sudo ./install_wolfssl.sh
```
</details>

<details>
<summary><b>âŒ Handshake Timeout</b></summary>

1. Verify all components are running:
```bash
ps aux | grep -E "litex_sim|dtls_pqc_server|uart_udp_bridge"
```

2. Check port availability:
```bash
sudo netstat -tulpn | grep -E "1234|4444"
```

3. Review logs:
```bash
tail -f logs/dtls_server.log
tail -f logs/uart_bridge.log
```
</details>

<details>
<summary><b>âŒ Certificate Verification Failed</b></summary>

```bash
# Regenerate all certificates
./generate_pqc_certs.sh

# Verify files exist
ls -la pqc_certs/*.der
```
</details>

<details>
<summary><b>âŒ Garbled/Corrupted Packets</b></summary>

Ensure you're using the **chunked bridge**, not the simple one:

```bash
# Use this (with reassembly support):
python3 uart_udp_bridge_chunked.py ...

# NOT this (raw forwarding):
python3 uart_udp_bridge.py ...
```
</details>

---

## ğŸ“š References

### Standards & Specifications
- [RFC 9147: DTLS 1.3](https://datatracker.ietf.org/doc/rfc9147/)
- [NIST FIPS 203: ML-KEM](https://csrc.nist.gov/pubs/fips/203/final)
- [NIST FIPS 204: ML-DSA (Dilithium)](https://csrc.nist.gov/pubs/fips/204/final)
- [NIST Post-Quantum Cryptography Project](https://csrc.nist.gov/projects/post-quantum-cryptography)

### Libraries & Frameworks
- [wolfSSL Documentation](https://www.wolfssl.com/documentation/)
- [LiteX Framework](https://github.com/enjoy-digital/litex)
- [VexRiscv CPU](https://github.com/SpinalHDL/VexRiscv)

### Algorithm Specifications
- [CRYSTALS-Dilithium](https://pq-crystals.org/dilithium/)
- [CRYSTALS-Kyber (ML-KEM)](https://pq-crystals.org/kyber/)

---

## ğŸ“„ License

This project is licensed under the **MIT License**.

```
MIT License

Copyright (c) 2025 PQC-DTLS RISC-V Project

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
```

---

## ğŸ™ Acknowledgments

<table>
<tr>
<td align="center" width="25%">
<b>Q-trino Labs</b><br/>
Problem Statement & Guidance
</td>
<td align="center" width="25%">
<b>Inter IIT Tech Meet 14.0</b><br/>
Competition Framework
</td>
<td align="center" width="25%">
<b>wolfSSL Inc.</b><br/>
SSL/TLS Library with PQC
</td>
<td align="center" width="25%">
<b>NIST</b><br/>
PQC Standardization
</td>
</tr>
</table>

---

<p align="center">
  <b>Built with â¤ï¸ for the Post-Quantum Era</b>
</p>

<p align="center">
  <i>Securing IoT devices against tomorrow's quantum threats, today.</i>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Quantum-Resistant-blueviolet?style=for-the-badge" alt="Quantum Resistant"/>
  <img src="https://img.shields.io/badge/NIST-Compliant-success?style=for-the-badge" alt="NIST Compliant"/>
  <img src="https://img.shields.io/badge/Open-Source-blue?style=for-the-badge" alt="Open Source"/>
</p>
